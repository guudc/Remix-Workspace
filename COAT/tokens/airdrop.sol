// SPDX-License-Identifier: MIT
/**

#  GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG
#  GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG
#  GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGCCCCCCCCCCCCCGGGGGOOOOOOOOOGGGGGGGGGGGGGGGGGAAAGGGGGGGGGTTTTTTTTTTTTTTTTTTTTTTTGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG
#  GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGCCC::::::::::::CGGGOO:::::::::OOGGGGGGGGGGGGGGA:::AGGGGGGGGT:::::::::::::::::::::TGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG
#  GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGCC:::::::::::::::CGOO:::::::::::::OOGGGGGGGGGGGA:::::AGGGGGGGT:::::::::::::::::::::TGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG
#  GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGC:::::CCCCCCCC::::CO:::::::OOO:::::::OGGGGGGGGGA:::::::AGGGGGGT:::::TT:::::::TT:::::TGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG
#  GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGC:::::CGGGGGGGCCCCCCO::::::OGGGO::::::OGGGGGGGGA:::::::::AGGGGGTTTTTTGGT:::::TGGTTTTTTGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG
#  GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGC:::::CGGGGGGGGGGGGGGO:::::OGGGGGO:::::OGGGGGGGA:::::A:::::AGGGGGGGGGGGGT:::::TGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG
#  GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGC:::::CGGGGGGGGGGGGGGO:::::OGGGGGO:::::OGGGGGGA:::::AGA:::::AGGGGGGGGGGGT:::::TGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG
#  GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGC:::::CGGGGGGGGGGGGGGO:::::OGGGGGO:::::OGGGGGA:::::AGGGA:::::AGGGGGGGGGGT:::::TGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG
#  GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGC:::::CGGGGGGGGGGGGGGO:::::OGGGGGO:::::OGGGGA:::::AGGGGGA:::::AGGGGGGGGGT:::::TGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG
#  GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGC:::::CGGGGGGGGGGGGGGO:::::OGGGGGO:::::OGGGA:::::AAAAAAAAA:::::AGGGGGGGGT:::::TGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG
#  GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGC:::::CGGGGGGGGGGGGGGO:::::OGGGGGO:::::OGGA:::::::::::::::::::::AGGGGGGGT:::::TGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG
#  GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGC:::::CGGGGGGGCCCCCCO::::::OGGGO::::::OGA:::::AAAAAAAAAAAAA:::::AGGGGGGT:::::TGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG
#  GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGC:::::CCCCCCCC::::CO:::::::OOO:::::::OA:::::AGGGGGGGGGGGGGA:::::AGGGTT:::::::TTGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG
#  GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGCC:::::::::::::::CGOO:::::::::::::OOA:::::AGGGGGGGGGGGGGGGA:::::AGGT:::::::::TGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG
#  GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGCCC::::::::::::CGGGOO:::::::::OOGA:::::AGGGGGGGGGGGGGGGGGA:::::AGT:::::::::TGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG
#  GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGCCCCCCCCCCCCCGGGGGOOOOOOOOOGGAAAAAAAGGGGGGGGGGGGGGGGGGGAAAAAAATTTTTTTTTTTGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG
#  GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG
#  GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG
#  GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG
#  GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG
#  GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG
#  GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG
#  GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG
#  GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG
#  GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGddddddddGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG
#  GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGd::::::dGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGffffffffffffffffGGGGGGGGGGGGGGGGGGGGGGGGGlllllllGlllllllGGGGGGGGGGGGGGGttttGGGGGGGGGGGGiiiiGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG
#  GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGd::::::dGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGf::::::::::::::::fGGGGGGGGGGGGGGGGGGGGGGGGl:::::lGl:::::lGGGGGGGGGGGGttt:::tGGGGGGGGGGGi::::iGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG
#  GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGd::::::dGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGf::::::::::::::::::fGGGGGGGGGGGGGGGGGGGGGGGl:::::lGl:::::lGGGGGGGGGGGGt:::::tGGGGGGGGGGGGiiiiGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG
#  GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGd:::::dGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGf::::::fffffff:::::fGGGGGGGGGGGGGGGGGGGGGGGl:::::lGl:::::lGGGGGGGGGGGGt:::::tGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG
#  GGGGccccccccccccccccGGGoooooooooooGGGGGGGddddddddd:::::dGGGGGeeeeeeeeeeeeGGGGrrrrrGGGrrrrrrrrrGGGGGGGGGGGoooooooooooGGGGf:::::fGGGGGGGffffffGGGGGGGaaaaaaaaaaaaaGGGGl::::lGGl::::lGGGGGGttttttt:::::tttttttGGGGiiiiiiiGGGGmmmmmmmGGGGmmmmmmmGGGGGGGeeeeeeeeeeeeGGGG
#  GGcc:::::::::::::::cGoo:::::::::::ooGGGdd::::::::::::::dGGGee::::::::::::eeGGr::::rrr:::::::::rGGGGGGGGoo:::::::::::ooGGf:::::fGGGGGGGGGGGGGGGGGGGGa::::::::::::aGGGl::::lGGl::::lGGGGGGt:::::::::::::::::tGGGGi:::::iGGmm:::::::mGGm:::::::mmGGGee::::::::::::eeGG
#  Gc:::::::::::::::::co:::::::::::::::oGd::::::::::::::::dGGe::::::eeeee:::::eer:::::::::::::::::rGGGGGGo:::::::::::::::of:::::::ffffffGGGGGGGGGGGGGGaaaaaaaaa:::::aGGl::::lGGl::::lGGGGGGt:::::::::::::::::tGGGGGi::::iGm::::::::::mm::::::::::mGe::::::eeeee:::::ee
#  c:::::::cccccc:::::co:::::ooooo:::::od:::::::ddddd:::::dGe::::::eGGGGGe:::::err::::::rrrrr::::::rGGGGGo:::::ooooo:::::of::::::::::::fGGGGGGGGGGGGGGGGGGGGGGGa::::aGGl::::lGGl::::lGGGGGGtttttt:::::::ttttttGGGGGi::::iGm::::::::::::::::::::::me::::::eGGGGGe:::::e
#  c::::::cGGGGGccccccco::::oGGGGGo::::od::::::dGGGGd:::::dGe:::::::eeeee::::::eGr:::::rGGGGGr:::::rGGGGGo::::oGGGGGo::::of::::::::::::fGGGGGGGGGGGGGGGGaaaaaaa:::::aGGl::::lGGl::::lGGGGGGGGGGGGt:::::tGGGGGGGGGGGi::::iGm:::::mmm::::::mmm:::::me:::::::eeeee::::::e
#  c:::::cGGGGGGGGGGGGGo::::oGGGGGo::::od:::::dGGGGGd:::::dGe:::::::::::::::::eGGr:::::rGGGGGrrrrrrrGGGGGo::::oGGGGGo::::of:::::::ffffffGGGGGGGGGGGGGGaa::::::::::::aGGl::::lGGl::::lGGGGGGGGGGGGt:::::tGGGGGGGGGGGi::::iGm::::mGGGm::::mGGGm::::me:::::::::::::::::eG
#  c:::::cGGGGGGGGGGGGGo::::oGGGGGo::::od:::::dGGGGGd:::::dGe::::::eeeeeeeeeeeGGGr:::::rGGGGGGGGGGGGGGGGGo::::oGGGGGo::::oGf:::::fGGGGGGGGGGGGGGGGGGGa::::aaaa::::::aGGl::::lGGl::::lGGGGGGGGGGGGt:::::tGGGGGGGGGGGi::::iGm::::mGGGm::::mGGGm::::me::::::eeeeeeeeeeeGG
#  c::::::cGGGGGccccccco::::oGGGGGo::::od:::::dGGGGGd:::::dGe:::::::eGGGGGGGGGGGGr:::::rGGGGGGGGGGGGGGGGGo::::oGGGGGo::::oGf:::::fGGGGGGGGGGGGGGGGGGa::::aGGGGa:::::aGGl::::lGGl::::lGGGGGGGGGGGGt:::::tGGGGttttttGi::::iGm::::mGGGm::::mGGGm::::me:::::::eGGGGGGGGGGG
#  c:::::::cccccc:::::co:::::ooooo:::::od::::::ddddd::::::dde::::::::eGGGGGGGGGGGr:::::rGGGGGGGGGGGGGGGGGo:::::ooooo:::::of:::::::fGGGGGGGGGGGGGGGGGa::::aGGGGa:::::aGl::::::ll::::::lGGGGGGGGGGGt::::::tttt:::::ti::::::im::::mGGGm::::mGGGm::::me::::::::eGGGGGGGGGG
#  Gc:::::::::::::::::co:::::::::::::::oGd:::::::::::::::::dGe::::::::eeeeeeeeGGGr:::::rGGGGGGGGGGGGGGGGGo:::::::::::::::of:::::::fGGGGGGGGGGGGGGGGGa:::::aaaa::::::aGl::::::ll::::::lGGGGGGGGGGGtt::::::::::::::ti::::::im::::mGGGm::::mGGGm::::mGe::::::::eeeeeeeeGG
#  GGcc:::::::::::::::cGoo:::::::::::ooGGGd:::::::::ddd::::dGGee:::::::::::::eGGGr:::::rGGGGGGGGGGGGGGGGGGoo:::::::::::ooGf:::::::fGGGGGGGGGGGGGGGGGGa::::::::::aa:::al::::::ll::::::lGGGGGGGGGGGGGtt:::::::::::tti::::::im::::mGGGm::::mGGGm::::mGGee:::::::::::::eGG
#  GGGGccccccccccccccccGGGoooooooooooGGGGGGdddddddddGGGdddddGGGGeeeeeeeeeeeeeeGGGrrrrrrrGGGGGGGGGGGGGGGGGGGGoooooooooooGGGfffffffffGGGGGGGGGGGGGGGGGGGaaaaaaaaaaGGaaaallllllllllllllllGGGGGGGGGGGGGGGtttttttttttGGiiiiiiiimmmmmmGGGmmmmmmGGGmmmmmmGGGGeeeeeeeeeeeeeeGG
#  GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG
#  GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG
#  GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG
#  GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG
#  GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG
#  GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG
#  GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG

 * @title Airdrop Contract
 * @dev A,adasun Goodness
 * CONTEXT:
 * This smart contract is designed to facilitate airdrops of both ERC20 tokens and ERC721 NFTs.
 * The contract allows an owner to distribute tokens or NFTs to whitelisted addresses in a secure manner.
 * It ensures that airdrops are claimed only once per round and prevents unauthorized access.
 *
 * OBJECTIVE:
 * - Enable token distribution (ERC20/ERC721) to a list of pre-approved addresses.
 * - Ensure each address can claim only once per airdrop round.
 * - Allow contract owner to manage the whitelist dynamically.
 * - Provide security checks for sufficient balances and NFT ownership.
*/

pragma solidity ^0.8.26;

import "@openzeppelin/contracts/token/ERC20/IERC20.sol";
import "@openzeppelin/contracts/token/ERC721/IERC721.sol";
import "@openzeppelin/contracts/token/ERC721/IERC721Receiver.sol"; 



contract Airdrop  {
    mapping(uint256 => mapping(address => bool)) internal _hasClaimed;
    address[] internal  _whiteList;
    /*
        This keeps tag of the current hasClaimed varaible used. 
        It allows for reseting of the airdrop
    */
    uint256 private airdropCount;
    /*
        This specify the airdrop type, 
        whether ERC20 or ERC721 but cannot be both.
        Default is ERC20
    */
    address internal tokenAddress; //The address of the token
    address internal fromAddress; //The address in which tokens are trasnferred from
    uint internal airdropType; //The airdrop type [1 for ERC20][2 for ERC721] [Default is 0 for ERC20]

    //EVENTS
    event airdroped(address[] recipients, uint256[] unitOfToken);
    event receivedTokens(address operator, address from, uint256 tokenId, bytes data);
    event TOKENtransfered(uint256 unitOfToken, string airdropType);
    event addressAddedToWhitelist(address[] _address);
    event removedAddress(address _address);

    /**
     * @dev Contract constructor initializes the airdrop settings.
     * @param _tokenAddress Address of the ERC20 or ERC721 token.
     * @param _fromAddress Address from which the tokens will be sent.
     * @param _airdropType Airdrop type (0 = ERC20, 1 = ERC721).
     */
     constructor(address _tokenAddress, address _fromAddress, uint _airdropType)  {
        require(_airdropType==0 || _airdropType==1, "Only 0 or 1 accepted as airdrop type");
        tokenAddress = _tokenAddress;
        fromAddress = _fromAddress;
        airdropType = _airdropType;//<<<<<------ Added New ------->>>>>
    }
    /**
    * @dev Starts the airdrop process for either ERC20 or ERC721 tokens.
    * @param unitOfToken Array specifying the amount (for ERC20) or token ID (for ERC721) to be sent.
    * @return True if the airdrop was successful.
    */
    function _startAirdrop(uint256[] calldata unitOfToken) internal returns(bool){
        require(tokenAddress != address(0), "Zero address");  // we need to add a functionality to check  whether a valid tokenID is passed or no or if we have entered number of tokens greater than total supply for startAirDrop functionality to work properly
        require(_whiteList.length > 0, "No whitelisted address");
        require(_whiteList.length == unitOfToken.length,"Number of Tokens and number of whitelisted addresses are not equal");
        IERC721 token; IERC20 _token;  
        //initializing the token type
        if(airdropType == 0) {
            _token = IERC20(tokenAddress);
        }
        else{
            token = IERC721(tokenAddress);
        }
        emit airdroped(_whiteList, unitOfToken);
        address recipient;
        for (uint i = 0; i < _whiteList.length; i++) {
            recipient = _whiteList[i];
            //checking if there is enough balance
            if(airdropType == 0) {require(_token.balanceOf(fromAddress) > unitOfToken[i],"Not enough balance");}
            else{require(token.ownerOf(unitOfToken[i]) == fromAddress, "Not the owner of this NFT[]");}
            if (!_hasClaimed[airdropCount][recipient]) {
                _hasClaimed[airdropCount][recipient] = true; // Mark as claimed 
                if(airdropType == 0){emit TOKENtransfered(unitOfToken[i], "Token");}else{emit TOKENtransfered(unitOfToken[i], "Nft");}  
                if(airdropType==0){_token.transferFrom(fromAddress, recipient, unitOfToken[i]);}
                else{token.transferFrom(fromAddress, recipient, unitOfToken[i]);} 
            }
        }
        return true;
    }

    /**
     * @dev Checks if an address is eligible for an airdrop.
     * @param _address Address to check.
     * @return True if eligible, false otherwise.
     */
    function getEligibility(address _address) public view returns(bool) {
        return !_hasClaimed[airdropCount][_address] && checkAddress(_address);
    }
    /**
     * @dev Adds addresses to the whitelist.
     * @param _address Array of addresses to whitelist.
    */
    function _whiteListAddress(address[] calldata _address) internal returns(bool) {
        for (uint i = 0; i < _address.length; i++) {
            require(_address[i] != address(0),"Zero Address present");
            if(airdropType==1){require(_checkReceiver(_address[i], 0), "Faulty address found");}
            require(!isWhiteListed(_address[i]),"Address allready Exists");
            _whiteList.push(_address[i]);
        }
        emit addressAddedToWhitelist(_address);
        return true;
    }
    /**
     * @dev Removes an address from the whitelist.
     * @param _address Address to remove.
    */
    function _removeFromWhiteList(address _address) internal returns(bool) {
        require(checkAddress(_address),"Address does not exist in the whitelist"); //<<<<<------Added New------->>>>>
        for (uint256 i = 0; i < _whiteList.length; i++) {
            if (_whiteList[i] == _address) {
                _whiteList[i] = _whiteList[_whiteList.length - 1];
                _whiteList.pop();
                emit removedAddress(_address);
                return true;
            }
        }
        return true;
    }
    /**
     * @dev Returns the list of whitelisted addresses.
    */
    function getWhiteList() public view returns(address[] memory) {
        return _whiteList;    
    }
    /**
     * @dev Returns the current airdrop version state
     * Useful to know the current airdrop version
    */
    function airdropVersion() public view returns(uint) {
        return airdropCount;    
    }
    /**
     * @dev Checks if an address is in the whitelist.
     * @param _address Address to check.
     * @return True if whitelisted, false otherwise.
    */
    function isWhiteListed(address _address) public view returns(bool) {
        return checkAddress(_address);
    }
    /**
     * @dev Reset an aurdrop.
     * @return True.
     */
    function _resetAirdrop() internal returns(bool) {
        airdropCount++;
        return true;
    }
    /*
        Implements the ability for this contract to recive ERC721 tokens
    */
    function onERC721Received(address operator, address from, uint256 tokenId, bytes memory data) public returns (bytes4) {
        // Handle the receipt of the ERC721 token
        emit receivedTokens(operator, from, tokenId, data);
        // Return the `bytes4` selector indicating the contract supports the ERC721 token transfer
        return IERC721Receiver.onERC721Received.selector;
    }
    /**
     * @dev Checks if an address exists in the whitelist.
     * @param target Address to check.
     * @return True if found, false otherwise.
     */
    function checkAddress(address target) internal view returns (bool) {
        uint256 len = _whiteList.length;
        for (uint256 i = 0; i < len; i++) {
            if (_whiteList[i] == target) {
                return true;
            }
        }
        return false;
    }

    /*
    * @dev Internal function to check if the receiver can recieve NFTs
    *This would help us prevent adding blocking addresses as whitelisted address
    */
    function _checkReceiver(address to, uint256 tokenId) private returns (bool) {
        // Check if the address is a contract
        if (isContract(to) == 0) {
            return true; //user address cannot be blocking
        }
        //contract address
        // Try to cast the address to the ITOKENReceiver interface
        IERC721Receiver receiver = IERC721Receiver(to);
        // Check if the contract implements the onNFTReceived function
        return receiver.onERC721Received(address(this), msg.sender, tokenId, "") == IERC721Receiver(to).onERC721Received.selector;
    }

    function isContract(address addr) private view returns(uint extSize) {
        assembly {
            extSize := extcodesize(addr) // returns 0 if EOA, >0 if smart contract
        }
    }
}

  